{
    "version": "https://jsonfeed.org/version/1",
    "title": "Tianciの小窝 • All posts by \"hexo\" category",
    "description": "一身清贫怎敢入繁华<br>两袖清风岂能误佳人",
    "home_page_url": "https://blog.lovetianci.cn",
    "items": [
        {
            "id": "https://blog.lovetianci.cn/Hexo/Hexo_Appveyor/",
            "url": "https://blog.lovetianci.cn/Hexo/Hexo_Appveyor/",
            "title": "Appveyor持续集成Hexo",
            "date_published": "2021-08-06T18:00:00.000Z",
            "content_html": "<h3 id=\"半年没写博客突然接触到一个新词叫做ci持续集成和cd持续交付\"><a class=\"markdownIt-Anchor\" href=\"#半年没写博客突然接触到一个新词叫做ci持续集成和cd持续交付\">#</a> 半年没写博客，突然接触到一个新词叫做 CI（持续集成）和 CD（持续交付）</h3>\n<h3 id=\"学习一下appveyor持续集成hexo并配置github-pages\"><a class=\"markdownIt-Anchor\" href=\"#学习一下appveyor持续集成hexo并配置github-pages\">#</a> 学习一下 AppVeyor 持续集成 Hexo 并配置 GitHub Pages</h3>\n<a id=\"more\"></a>\n<h3 id=\"创建项目在-projects-页面选择你的博客源码仓库\"><a class=\"markdownIt-Anchor\" href=\"#创建项目在-projects-页面选择你的博客源码仓库\">#</a> 创建项目，在 /projects 页面选择你的博客源码仓库</h3>\n<p><img data-src=\"project.png\" alt=\"创建项目\"></p>\n<h3 id=\"点击项目中-settings-选项卡如果项目分支不是默认的修改-default-branch\"><a class=\"markdownIt-Anchor\" href=\"#点击项目中-settings-选项卡如果项目分支不是默认的修改-default-branch\">#</a> 点击项目中 SETTINGS 选项卡，如果项目分支不是默认的，修改 Default branch</h3>\n<h3 id=\"再点击-environment-栏目设置4个环境变量\"><a class=\"markdownIt-Anchor\" href=\"#再点击-environment-栏目设置4个环境变量\">#</a> 再点击 Environment 栏目，设置 4 个环境变量：</h3>\n<table>\n<thead>\n<tr>\n<th>name</th>\n<th>value</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>STATIC_SITE_REPO</td>\n<td>静态网址文件存放 git 地址</td>\n</tr>\n<tr>\n<td>TARGET_BRANCH</td>\n<td>分支（默认 master）</td>\n</tr>\n<tr>\n<td>GIT_USER_EMAIL</td>\n<td>git 账号</td>\n</tr>\n<tr>\n<td>GIT_USER_NAME</td>\n<td>git 名称</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"github-添加access-token\"><a class=\"markdownIt-Anchor\" href=\"#github-添加access-token\">#</a> GitHub 添加 Access Token</h3>\n<h3 id=\"在httpsciappveyorcomtoolsencrypt页面加密\"><a class=\"markdownIt-Anchor\" href=\"#在httpsciappveyorcomtoolsencrypt页面加密\">#</a> 在<span class=\"exturl\" data-url=\"aHR0cHM6Ly9jaS5hcHB2ZXlvci5jb20vdG9vbHMvZW5jcnlwdA==\"> https://ci.appveyor.com/tools/encrypt</span> 页面加密</h3>\n<h3 id=\"配置ci项目根目录添加appveyoryml\"><a class=\"markdownIt-Anchor\" href=\"#配置ci项目根目录添加appveyoryml\">#</a> 配置 CI，项目根目录添加 appveyor.yml</h3>\n<figure class=\"highlight yaml\"><figcaption data-lang=\"YAML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token key atrule\">clone_depth</span><span class=\"token punctuation\">:</span> <span class=\"token number\">5</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token key atrule\">access_token</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token key atrule\">secure</span><span class=\"token punctuation\">:</span> You Access Token</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token key atrule\">matrix</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">nodejs_version</span><span class=\"token punctuation\">:</span> \"12\" //因为node 14版本生成页面和文件为空，这里改为12版本</pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token key atrule\">install</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">ps</span><span class=\"token punctuation\">:</span> Install<span class=\"token punctuation\">-</span>Product node $env<span class=\"token punctuation\">:</span>nodejs_version</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token punctuation\">-</span> node <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>version</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token punctuation\">-</span> npm <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>version</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token punctuation\">-</span> npm install</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token punctuation\">-</span> npm install hexo<span class=\"token punctuation\">-</span>cli <span class=\"token punctuation\">-</span>g</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token key atrule\">build_script</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token punctuation\">-</span> hexo generate</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token key atrule\">artifacts</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">path</span><span class=\"token punctuation\">:</span> public</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token key atrule\">on_success</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token punctuation\">-</span> git config <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>global credential.helper store</pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">ps</span><span class=\"token punctuation\">:</span> Add<span class=\"token punctuation\">-</span>Content \"$env<span class=\"token punctuation\">:</span>USERPROFILE\\.git<span class=\"token punctuation\">-</span>credentials\" \"https<span class=\"token punctuation\">:</span>//$($env<span class=\"token punctuation\">:</span>access_token)<span class=\"token punctuation\">:</span>x<span class=\"token punctuation\">-</span>oauth<span class=\"token punctuation\">-</span>basic@github.com`n\"</pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token punctuation\">-</span> git config <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>global user.email \"%GIT_USER_EMAIL%\"</pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token punctuation\">-</span> git config <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>global user.name \"%GIT_USER_NAME%\"</pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token punctuation\">-</span> git clone <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>depth 5 <span class=\"token punctuation\">-</span>q <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>branch=%TARGET_BRANCH% %STATIC_SITE_REPO% %TEMP%\\static<span class=\"token punctuation\">-</span>site</pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token punctuation\">-</span> cd %TEMP%\\static<span class=\"token punctuation\">-</span>site</pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    <span class=\"token punctuation\">-</span> del * /f /q</pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    <span class=\"token punctuation\">-</span> for /d %%p IN (<span class=\"token important\">*)</span> do rmdir \"%%p\" /s /q</pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token punctuation\">-</span> SETLOCAL EnableDelayedExpansion &amp; robocopy \"%APPVEYOR_BUILD_FOLDER%\\public\" \"%TEMP%\\static<span class=\"token punctuation\">-</span>site\" /e &amp; IF <span class=\"token tag\">!ERRORLEVEL</span><span class=\"token tag\">!</span> EQU 1 (exit 0) ELSE (IF <span class=\"token tag\">!ERRORLEVEL</span><span class=\"token tag\">!</span> EQU 3 (exit 0) ELSE (exit 1))</pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token punctuation\">-</span> git add <span class=\"token punctuation\">-</span>A</pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    <span class=\"token punctuation\">-</span> git commit <span class=\"token punctuation\">-</span>m \"Update Static Site\"</pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    <span class=\"token punctuation\">-</span> git push origin %TARGET_BRANCH%</pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    <span class=\"token punctuation\">-</span> appveyor AddMessage \"Static Site Updated\"</pre></td></tr></table></figure><h3 id=\"最后代码提交到gitappveyor会自动接收到更新并build提交到指定git仓库\"><a class=\"markdownIt-Anchor\" href=\"#最后代码提交到gitappveyor会自动接收到更新并build提交到指定git仓库\">#</a> 最后代码提交到 Git，AppVeyor 会自动接收到更新并 build 提交到指定 Git 仓库</h3>\n<h3 id=\"之后更新博客以及代码只需要push即可\"><a class=\"markdownIt-Anchor\" href=\"#之后更新博客以及代码只需要push即可\">#</a> 之后更新博客以及代码只需要 push 即可</h3>\n",
            "tags": [
                "技术"
            ]
        }
    ]
}